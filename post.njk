---
layout: layouts/main.njk
pagination:
  data: collections.posts
  size: 1
  alias: post
eleventyComputed:
  title: "El Archivo de dSong » {{ post.title }}"
permalink: "archive/{{ post.id }}.html"
---

<div class="post-view">
  <h2 class="post-view__title">{{ post.title }}</h2>

  <div class="post-view__meta">
    <span>
      <span class="post-view__editor">
        {% if post.editor.url %}
          <a href="{{ post.editor.url }}" target="_blank">
            <img class="post-view__editor-image" src="{{ post.editor.gravatar_url }}?s=20" />
            <span class="post-view__editor-name">{{ post.editor.name }}</span>
          </a>
        {% else %}
          <span>
            <img class="post-view__editor-image" src="{{ post.editor.gravatar_url }}?s=20" />
            <span class="post-view__editor-name">{{ post.editor.name }}</span>
          </span>
        {% endif %}
      </span>

      <span class="post-view__date">{{ post.published_at | formatDate("dd/MM/yyyy") }}</span>

      {% set commentsCount = post.comments | length %}
      {% if commentsCount == 0 %}
        <span class="post-view__comments-count">Sin comentarios</span>
      {% elif commentsCount == 1 %}
        <span class="post-view__comments-count">{{ commentsCount }} comentario</span>
      {% else %}
        <span class="post-view__comments-count">{{ commentsCount }} comentarios</span>
      {% endif %}
    </span>
  </div>

  <div class="post-view__content">
    {{ post.content | markdown | safe }}
  </div>

  {% if post.metadata.podcast_file %}
    <div class="post-view__media post-view__media--podcast">
      <h3 class="post-view__subtitle">Reproducir el podcast de UniRadio Jaén</h3>
      <audio controls src="https://dsongstatic.jesusmagamu.dev/mp3/podcast/{{ post.metadata.podcast_file }}">Tu navegador no soporta este tipo de reproductor</audio>
    </div>
  {% endif %}

  {% if post.metadata.youtube_code %}
    <div class="post-view__media post-view__media--youtube">
      <h3 class="post-view__subtitle">Reproducir en YouTube</h3>
      <div class="post-view__media-container">
        <iframe src="https://www.youtube.com/embed/{{ post.metadata.youtube_code }}" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </div>
  {% endif %}

  {% if post.metadata.spotify_url %}
    <div class="post-view__media post-view__media--spotify">
      <h3 class="post-view__subtitle">Reproducir en Spotify</h3>
      <div>
        <iframe src="{{ post.metadata.spotify_url }}" width="100%" height="80" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>
      </div>
    </div>
  {% endif %}

  {% if post.comments and post.comments | length > 0 %}
    <div class="post-view__comments">
      <h3 class="post-view__subtitle">Comentarios</h3>
      <ul>
        {% for comment in post.comments %}
          <li class="post-view__comment">
            <div class="post-view__comment-content">{{ comment.content }}</div>
            <div class="post-view__comment-meta">
              <span class="post-view__comment-author">
                —
                {% if comment.author.url %}
                  <a href="{{ comment.author.url }}" target="_blank">
                    <span class="post-view__comment-author-name">{{ comment.author.name }}</span>
                  </a>
                {% else %}
                  <span>
                    <span class="post-view__comment-author-name">{{ comment.author.name }}</span>
                  </span>
                {% endif %}
              </span>
              <span class="post-view__comment-date">{{ comment.published_at | formatDate("dd/MM/yyyy") }}</span>
            </div>
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
</div>
